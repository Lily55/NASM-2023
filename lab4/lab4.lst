     1                                  %include "lib.asm"
     2                              <1>           section .text     ; ������� ����
     3                              <1> IntToStr64:
     4 00000000 57                  <1>          push   rdi
     5 00000001 53                  <1>          push   rbx
     6 00000002 52                  <1>          push   rdx
     7 00000003 51                  <1>          push   rcx
     8 00000004 56                  <1> 		 push   rsi
     9 00000005 C60600              <1> 		 mov    byte[rsi],0 ; �� ����� �����
    10 00000008 83F800              <1>          cmp    eax,0
    11 0000000B 7D05                <1>          jge    .l1
    12 0000000D F7D8                <1>          neg    eax
    13 0000000F C6062D              <1>          mov    byte[rsi],'-'
    14 00000012 C6460620            <1> .l1      mov    byte[rsi+6],' '
    15 00000016 BF05000000          <1>          mov    rdi,5
    16 0000001B 66BB0A00            <1>          mov    bx,10
    17 0000001F 6699                <1> .again:  cwd           ; ��������� ����� �� ��������
    18 00000021 66F7F3              <1>          div    bx     ; ����� ��������� �� 10
    19 00000024 80C230              <1>          add    dl,30h ; �������� �� ������� ��� �����
    20 00000027 88143E              <1>          mov    [rsi+rdi],dl ; ����� ������ � ������
    21 0000002A 48FFCF              <1>          dec    rdi    ; ��������� ��������� ��
    22                              <1>                        ; ���������� �������
    23 0000002D 6683F800            <1>          cmp    ax, 0  ; ������������� ��� �����?
    24 00000031 75EC                <1>          jne    .again
    25 00000033 B906000000          <1>          mov    rcx, 6
    26 00000038 4829F9              <1>          sub    rcx, rdi ; ����� ����������+����
    27 0000003B 4889C8              <1> 		 mov    rax,rcx
    28 0000003E 48FFC0              <1> 		 inc    rax    ; ����� ����������+OA
    29 00000041 48FFC6              <1>          inc    rsi    ; ���������� ����
    30 00000044 56                  <1> 		 push   rsi
    31 00000045 488D343E            <1>          lea    rsi,[rsi+rdi] ; ������ ����������
    32 00000049 5F                  <1> 		 pop    rdi
    33 0000004A F3A4                <1>          rep movsb
    34 0000004C 5E                  <1>          pop    rsi
    35 0000004D 59                  <1>          pop    rcx
    36 0000004E 5A                  <1>          pop    rdx
    37 0000004F 5B                  <1>          pop    rbx
    38 00000050 5F                  <1>          pop    rdi
    39 00000051 C3                  <1>          ret
    40                              <1> StrToInt64:
    41 00000052 57                  <1>          push   rdi
    42 00000053 B739                <1>          mov    bh, '9'
    43 00000055 B330                <1>          mov    bl, '0'
    44 00000057 56                  <1>          push   rsi     ; ��������� ����� �������� ������
    45 00000058 803E2D              <1>          cmp    byte[rsi], '-'
    46 0000005B 7503                <1>          jne    .prod
    47 0000005D 48FFC6              <1>          inc    rsi     ; ���������� ����
    48 00000060 FC                  <1> .prod    cld
    49 00000061 6631FF              <1>          xor    di, di  ; �������� ������� �����
    50 00000064 AC                  <1> .cycle:  lodsb          ; ��������� ������ (�����)
    51 00000065 3C0A                <1>          cmp    al, 10  ; ���� 10, �� �� �����
    52 00000067 741F                <1>          je     .Return
    53 00000069 38D8                <1>          cmp    al, bl  ; ���������� � ����� ����
    54 0000006B 722F                <1>          jb     .Error  ; "����" � ������
    55 0000006D 38F8                <1>          cmp    al, bh  ; ���������� � ����� ������
    56 0000006F 772B                <1>          ja     .Error  ; "����" � ������
    57 00000071 2C30                <1>          sub    al, 30h ; �������� ����� �� �������
    58 00000073 6698                <1>          cbw            ; ��������� �� �����
    59 00000075 6650                <1>          push   ax      ; ��������� � �����
    60 00000077 66B80A00            <1>          mov    ax, 10  ; ������� 10 � AX
    61 0000007B 66F7E7              <1>          mul    di      ; ��������, ��������� � DX:AX
    62 0000007E 665F                <1>          pop    di      ; � DI � ��������� �����
    63 00000080 6601F8              <1>          add    ax, di
    64 00000083 6689C7              <1>          mov    di, ax  ; � DI � ����������� �����
    65 00000086 EBDC                <1>          jmp    .cycle
    66 00000088 5E                  <1> .Return: pop    rsi
    67 00000089 BB00000000          <1>          mov    rbx, 0
    68 0000008E 803E2D              <1>          cmp    byte[rsi], '-'
    69 00000091 7503                <1>          jne    .J
    70 00000093 66F7DF              <1>          neg    di
    71 00000096 6689F8              <1> .J       mov    ax, di
    72 00000099 98                  <1>          cwde
    73 0000009A EB0B                <1>          jmp    .R
    74 0000009C 5E                  <1> .Error:  pop    rsi
    75 0000009D B800000000          <1>          mov    rax, 0
    76 000000A2 BB01000000          <1>          mov    rbx, 1
    77 000000A7 5F                  <1> .R       pop    rdi
    78 000000A8 C3                  <1>          ret
     2                                  
     3                                  section .data
     4 00000000 030009000200020005-     MAS dw 3, 9, 2, 2, 5, 8, 1, 5, -1, 8, 10, 15, 9, 5, -1
     4 00000009 00080001000500FFFF-
     4 00000012 08000A000F00090005-
     4 0000001B 00FFFF             
     5 0000001E 0A                      ExitMsg db "",10
     6                                  lenExit equ $-ExitMsg
     7                                  
     8                                  section .bss
     9 00000000 <res 1Eh>               NewUnicMAS resw 15
    10 0000001E <res 1Eh>               NewMAS resw 15
    11 0000003C <res Ah>                OutBuf resb 10
    12                                  
    13                                  section .text
    14                                  global _start
    15                                  
    16                                  _start:
    17                                  
    18 000000A9 BB00000000                  mov ebx, 0
    19 000000AE B90F000000                  mov ecx, 15
    20 000000B3 4831F6                      xor rsi, rsi
    21 000000B6 4831FF                      xor rdi, rdi
    22                                  
    23                                  cycle1:         ; цикл прохода по массиву MAS в поиске уникальных элементов
    24 000000B9 51                          push rcx
    25 000000BA 66BA0000                    mov dx, 0
    26 000000BE B90F000000                  mov ecx, 15
    27 000000C3 66678B841B-                 mov ax, [ebx*2 + MAS]
    27 000000C8 [00000000]         
    28 000000CC 53                          push rbx
    29 000000CD BB00000000                  mov ebx, 0
    30                                  cycle2:         ; цикл в котором происходит сравнение
    31                                          ; текущего элемента цикла1 со всеми
    32 000000D2 66673B841B-                 cmp ax, [ebx*2 + MAS] ; элементами массива MAS для выявления уникального элемента
    32 000000D7 [00000000]         
    33 000000DB 7402                        je plus
    34 000000DD EB03                        jmp next1
    35                                  plus:
    36 000000DF 66FFC2                      inc dx      ; при нахождении повторения увеличиваем счётчик на 1
    37                                  next1:
    38 000000E2 FFC3                        inc ebx 
    39 000000E4 E2EC                        loop cycle2
    40                                  
    41 000000E6 6683FA02                    cmp dx, 2   ; если счётчик равен 1, то это уникальный элемент
    42 000000EA 7C04                        jl dobU
    43 000000EC 7D0F                        jge dobR
    44 000000EE EB18                        jmp next2
    45                                  dobU:
    46 000000F0 66898436[00000000]          mov [rsi*2 + NewUnicMAS], ax    ; добавляем уникальные элементы в NewUnicMAS
    47 000000F8 48FFC6                      inc rsi
    48 000000FB EB0B                        jmp next2
    49                                  dobR:
    50 000000FD 6689843F[1E000000]          mov [rdi*2 + NewMAS], ax    ; добавляем повторяющиеся элменеты в NewMAS
    51 00000105 48FFC7                      inc rdi
    52                                  next2:
    53 00000108 5B                          pop rbx
    54 00000109 FFC3                        inc ebx
    55 0000010B 59                          pop rcx
    56 0000010C E2AB                        loop cycle1
    57                                  
    58 0000010E BB00000000                  mov ebx, 0
    59 00000113 4889F1                      mov rcx, rsi
    60                                  cycle5:
    61 00000116 66678B841B-                 mov ax, [ebx*2 + NewUnicMAS]
    61 0000011B [00000000]         
    62 0000011F 666789841B-                 mov [ebx*2 + MAS], ax
    62 00000124 [00000000]         
    63 00000128 FFC3                        inc ebx
    64 0000012A E2EA                        loop cycle5
    65                                  
    66 0000012C 89DA                        mov edx, ebx
    67 0000012E BB00000000                  mov ebx, 0
    68 00000133 4889F9                      mov rcx, rdi
    69                                  cycle6:
    70 00000136 66678B841B-                 mov ax, [ebx*2 + NewMAS]
    70 0000013B [1E000000]         
    71 0000013F 6667898412-                 mov [edx*2 + MAS], ax
    71 00000144 [00000000]         
    72 00000148 FFC3                        inc ebx
    73 0000014A FFC2                        inc edx
    74 0000014C E2E8                        loop cycle6
    75                                  
    76                                  
    77                                  ;     mov ebx, 0
    78                                  ;     mov ecx, 12
    79                                  ; cycle3:
    80                                  ;     mov ax, [ebx*2 + NewUnicMAS]
    81                                  ;     inc ebx
    82                                  ;     push rcx
    83                                  
    84                                  ;     ; конвертируем частное из целого в строку
    85                                  ;     mov esi, OutBuf
    86                                  ;     cwde
    87                                  ;     call IntToStr64
    88                                  
    89                                  ;     ; write
    90                                  ;     mov edx, eax
    91                                  ;     mov eax, 1        
    92                                  ;     mov edi, 1        
    93                                  ;     syscall 
    94                                  
    95                                  ;     pop rcx
    96                                  ;     loop cycle3
    97                                  
    98                                  ; ;end:
    99                                  ;     ; write ExitMsg
   100                                  ;     mov     rax, 1        
   101                                  ;     mov     rdi, 1        
   102                                  ;     mov     rsi, ExitMsg  
   103                                  ;     mov     rdx, lenExit  
   104                                  ;     syscall  
   105                                  
   106 0000014E BB00000000                  mov ebx, 0
   107 00000153 B90F000000                  mov ecx, 15
   108                                  cycle4:
   109 00000158 66678B841B-                 mov ax, [ebx*2 + MAS]
   109 0000015D [00000000]         
   110 00000161 FFC3                        inc ebx
   111 00000163 51                          push rcx
   112                                  
   113                                      ; конвертируем частное из целого в строку
   114 00000164 BE[3C000000]                mov esi, OutBuf
   115 00000169 98                          cwde
   116 0000016A E891FEFFFF                  call IntToStr64
   117                                  
   118                                      ; write
   119 0000016F 89C2                        mov edx, eax
   120 00000171 B801000000                  mov eax, 1        
   121 00000176 BF01000000                  mov edi, 1        
   122 0000017B 0F05                        syscall 
   123                                  
   124 0000017D 59                          pop rcx
   125 0000017E E2D8                        loop cycle4  
   126                                  
   127                                      ; write ExitMsg
   128 00000180 B801000000                  mov     rax, 1        
   129 00000185 BF01000000                  mov     rdi, 1        
   130 0000018A 48BE-                       mov     rsi, ExitMsg  
   130 0000018C [1E00000000000000] 
   131 00000194 BA01000000                  mov     rdx, lenExit  
   132 00000199 0F05                        syscall  
   133                                  
   134                                      ;exit
   135 0000019B B83C000000                  mov rax, 60
   136 000001A0 4831FF                      xor rdi, rdi
   137 000001A3 0F05                        syscall
